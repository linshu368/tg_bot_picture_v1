# å¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æ£€éªŒæ–¹æ¡ˆ

## ğŸ“– æ¦‚è¿°

æœ¬æ–‡æ¡£åŸºäº `ImageService` è¿ç§»å®è·µç»éªŒï¼Œæä¾›äº†ä¸€å¥—é€šç”¨çš„å¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æ£€éªŒæ–¹æ¡ˆï¼Œç”¨äºéªŒè¯æ–°æ—§Repositoryåœ¨è¿ç§»è¿‡ç¨‹ä¸­çš„æ•°æ®ä¸€è‡´æ€§ï¼Œç¡®ä¿ä¸šåŠ¡é€»è¾‘ä¿æŒå®Œå…¨ä¸€è‡´ã€‚

## ğŸ¯ æ ¸å¿ƒåŸç†

### æ£€éªŒç›®æ ‡
- **æ•°æ®ä¸€è‡´æ€§**ï¼šç¡®ä¿æ–°æ—§Repositoryå†™å…¥çš„æ•°æ®å®Œå…¨ç›¸åŒ
- **ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§**ï¼šç¡®ä¿æ–°Repositoryä¸æ”¹å˜ä»»ä½•ä¸šåŠ¡è®¡ç®—é€»è¾‘
- **è¿ç§»å®‰å…¨æ€§**ï¼šä¸ºç”Ÿäº§ç¯å¢ƒè¿ç§»æä¾›ä¿¡å¿ƒä¿éšœ

### æ£€éªŒåŸç†
```
åŒä¸€ä»½ä¸šåŠ¡æ•°æ® â†’ åˆ†åˆ«è°ƒç”¨æ–°æ—§Repository â†’ ä»æ•°æ®åº“æŸ¥è¯¢å®é™…ç»“æœ â†’ é€å­—æ®µå¯¹æ¯”ä¸€è‡´æ€§
```

## ğŸ—ï¸ é€šç”¨æµ‹è¯•æ¶æ„

### 1. æµ‹è¯•ç±»ç»“æ„æ¨¡æ¿

```python
class ServiceConsistencyTester:
    """é€šç”¨Serviceä¸€è‡´æ€§æµ‹è¯•å™¨"""
    
    def __init__(self):
        self.old_repo = None        # æ—§Repositoryå®ä¾‹
        self.new_repo = None        # æ–°Repositoryå®ä¾‹  
        self.supabase_manager = None
        self.container = None
        self.test_stats = {
            'total': 0,
            'consistent': 0,
            'inconsistent': 0,
            'differences': []
        }
    
    async def setup(self):
        """ç¯å¢ƒåˆå§‹åŒ–"""
        pass
        
    async def create_test_data(self):
        """åˆ›å»ºæµ‹è¯•åŸºç¡€æ•°æ®"""
        pass
        
    async def execute_test_tasks(self, test_tasks):
        """æ‰§è¡Œå¹¶è¡Œå†™å…¥æµ‹è¯•"""
        pass
        
    async def compare_records(self, task_data, old_result, new_result):
        """å¯¹æ¯”è®°å½•ä¸€è‡´æ€§"""
        pass
        
    async def generate_report(self):
        """ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š"""
        pass
```

### 2. é…ç½®ç®¡ç†æ¨¡æ¿

```python
# ç¯å¢ƒå˜é‡è®¾ç½®
def setup_test_environment(service_name: str):
    """è®¾ç½®æµ‹è¯•ç¯å¢ƒå˜é‡"""
    os.environ.update({
        'SUPABASE_URL': 'your_supabase_url',
        'SUPABASE_KEY': 'your_supabase_key',
        'SUPABASE_SERVICE_KEY': 'your_service_key',
        f'{service_name.upper()}_SERVICE_MIGRATION_MODE': 'parallel_test'
    })
```

## ğŸ”„ æ ‡å‡†æµ‹è¯•æµç¨‹

### é˜¶æ®µ1ï¼šç¯å¢ƒå‡†å¤‡
1. **é…ç½®ç¯å¢ƒå˜é‡**
   - æ•°æ®åº“è¿æ¥å‚æ•°
   - Serviceè¿ç§»æ¨¡å¼è®¾ç½®
   - æ—¥å¿—çº§åˆ«é…ç½®

2. **åˆå§‹åŒ–ç»„ä»¶**
   - Containerå®¹å™¨åˆå§‹åŒ–
   - Repositoryå®ä¾‹è·å–
   - Supabaseå®¢æˆ·ç«¯è¿æ¥

3. **åˆ›å»ºåŸºç¡€æ•°æ®**
   - æµ‹è¯•ç”¨æˆ·åˆ›å»ºï¼ˆæ–°æ—§è¡¨åŒæ­¥ï¼‰
   - ä¾èµ–æ•°æ®å‡†å¤‡
   - å¤–é”®çº¦æŸæ»¡è¶³

### é˜¶æ®µ2ï¼šå¹¶è¡Œå†™å…¥æµ‹è¯•
1. **ç”Ÿæˆæµ‹è¯•ä»»åŠ¡**
   ```python
   test_tasks = [
       TestTask(
           user_id=1000,
           business_data={...},
           expected_cost=10,
           task_type='business_type_1'
       ),
       # ... æ›´å¤šæµ‹è¯•ç”¨ä¾‹
   ]
   ```

2. **æ‰§è¡Œå¹¶è¡Œå†™å…¥**
   ```python
   for task in test_tasks:
       # å†™å…¥æ—§Repository
       old_result = await old_repo.create_xxx(task.to_old_format())
       
       # å†™å…¥æ–°Repository  
       new_result = await new_repo.create_xxx_with_payment(
           user_id=task.user_id,
           **task.to_new_format()
       )
       
       # è®°å½•ç»“æœç”¨äºåç»­å¯¹æ¯”
       await self.compare_records(task, old_result, new_result)
   ```

### é˜¶æ®µ3ï¼šæ•°æ®éªŒè¯
1. **ä»æ•°æ®åº“æŸ¥è¯¢å®é™…æ•°æ®**
   ```python
   old_data = await old_repo.get_by_id(record_id)
   new_data = await new_repo.get_by_id(record_id)
   ```

2. **é€å­—æ®µå¯¹æ¯”**
   ```python
   compare_fields = ['user_id', 'business_id', 'amount', 'status', 'cost']
   
   for field in compare_fields:
       old_val = old_record.get(field)
       new_val = new_record.get(field)
       if old_val != new_val:
           self.record_difference(field, old_val, new_val)
   ```

### é˜¶æ®µ4ï¼šæŠ¥å‘Šç”Ÿæˆ
1. **ç»Ÿè®¡æ±‡æ€»**
   - æ€»æµ‹è¯•æ•°é‡
   - ä¸€è‡´æ€§è®°å½•æ•°
   - ä¸ä¸€è‡´è®°å½•æ•°
   - ä¸€è‡´æ€§ç™¾åˆ†æ¯”

2. **å·®å¼‚è¯¦æƒ…**
   - å­—æ®µçº§å·®å¼‚åˆ—è¡¨
   - å·®å¼‚åŸå› åˆ†æ
   - ä¿®å¤å»ºè®®

## âš ï¸ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. ç¯å¢ƒåˆå§‹åŒ–é—®é¢˜

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| `Supabaseå®¢æˆ·ç«¯æœªåˆå§‹åŒ–` | ç¼ºå°‘ç¯å¢ƒå˜é‡æˆ–åˆå§‹åŒ–è°ƒç”¨ | è®¾ç½®å®Œæ•´ç¯å¢ƒå˜é‡ï¼Œè°ƒç”¨`await supabase_manager.initialize()` |
| `Containeræ³¨å…¥å¤±è´¥` | Repositoryæœªæ³¨å†Œæˆ–ä¾èµ–ç¼ºå¤± | æ£€æŸ¥`container.py`ä¸­çš„factoryæ³¨å†Œ |

### 2. æ•°æ®åˆ›å»ºé—®é¢˜

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| `å¤–é”®çº¦æŸè¿å` | æµ‹è¯•æ•°æ®ä¸å­˜åœ¨äºå…³è”è¡¨ | åœ¨æ–°æ—§è¡¨ä¸­åˆ›å»ºç›¸åŒçš„åŸºç¡€æ•°æ® |
| `å­—æ®µä¸å­˜åœ¨é”™è¯¯` | ä½¿ç”¨äº†æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„å­—æ®µ | ä¸¥æ ¼æŒ‰ç…§çœŸå®è¡¨ç»“æ„åˆ›å»ºæ•°æ® |
| `æ•°æ®ç±»å‹é”™è¯¯` | å­—æ®µç±»å‹ä¸åŒ¹é…ï¼ˆå¦‚UUID vs Stringï¼‰ | æ£€æŸ¥è¡¨ç»“æ„ï¼Œä½¿ç”¨æ­£ç¡®çš„æ•°æ®ç±»å‹ |

### 3. ä¸šåŠ¡é€»è¾‘ä¸ä¸€è‡´

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| `è®¡ç®—ç»“æœä¸åŒ` | æ–°Repositoryä½¿ç”¨äº†ä¸åŒçš„è®¡ç®—é€»è¾‘ | ä¿®æ”¹æ–°Repositoryï¼Œä¿æŒè®¡ç®—é€»è¾‘ä¸€è‡´ |
| `å‚æ•°ä¼ é€’ä¸¢å¤±` | æ–°Repositoryå¿½ç•¥äº†å¤–éƒ¨ä¼ å…¥çš„å‚æ•° | æ·»åŠ å‚æ•°æ”¯æŒï¼Œä¼˜å…ˆä½¿ç”¨å¤–éƒ¨ä¼ å…¥å€¼ |
| `é»˜è®¤å€¼ä¸åŒ` | æ–°æ—§Repositoryä½¿ç”¨äº†ä¸åŒçš„é»˜è®¤å€¼ | ç»Ÿä¸€é»˜è®¤å€¼é…ç½® |

## ğŸ“‹ æµ‹è¯•ç”¨ä¾‹è®¾è®¡æŒ‡å—

### 1. åŸºç¡€åŠŸèƒ½æµ‹è¯•
```python
# æ­£å¸¸ä¸šåŠ¡æµç¨‹
TestCase(
    name="æ­£å¸¸åˆ›å»ºä»»åŠ¡",
    user_id=1000,
    business_data={"type": "normal", "amount": 10},
    expected_result="success"
)
```

### 2. è¾¹ç•Œæ¡ä»¶æµ‹è¯•
```python
# æœ€å°å€¼æµ‹è¯•
TestCase(
    name="æœ€å°æˆæœ¬ä»»åŠ¡",
    user_id=1001, 
    business_data={"type": "minimal", "amount": 1},
    expected_result="success"
)

# æœ€å¤§å€¼æµ‹è¯•  
TestCase(
    name="æœ€å¤§æˆæœ¬ä»»åŠ¡",
    user_id=1002,
    business_data={"type": "premium", "amount": 100},
    expected_result="success"
)
```

### 3. å¼‚å¸¸æƒ…å†µæµ‹è¯•
```python
# ä½™é¢ä¸è¶³
TestCase(
    name="ä½™é¢ä¸è¶³",
    user_id=1003,
    business_data={"type": "expensive", "amount": 9999},
    expected_result="insufficient_balance"
)
```

### 4. ä¸šåŠ¡é€»è¾‘æµ‹è¯•
```python
# å¤æ‚è®¡ç®—é€»è¾‘
TestCase(
    name="åŠ¨æ€æˆæœ¬è®¡ç®—",
    user_id=1004,
    business_data={"type": "dynamic", "complexity": 5, "premium": True},
    expected_result="success",
    validate_cost=True  # é‡ç‚¹éªŒè¯æˆæœ¬è®¡ç®—ä¸€è‡´æ€§
)
```

## ğŸ”§ å®ç°æ¨¡æ¿

### 1. æµ‹è¯•è„šæœ¬æ¨¡æ¿

```python
#!/usr/bin/env python3
"""
{ServiceName}å¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æµ‹è¯•
ç”¨æ³•: python test_{service_name}_parallel_write_consistency.py --mode=quick --records=10
"""

import asyncio
import argparse
import os
from typing import List, Dict, Any, Optional
from dataclasses import dataclass

# å¯¼å…¥å¿…è¦çš„ç»„ä»¶
from src.core.container import get_container
from src.infrastructure.database.supabase_manager import SupabaseManager

@dataclass
class TestTask:
    """æµ‹è¯•ä»»åŠ¡æ•°æ®ç»“æ„"""
    user_id: int
    task_type: str
    business_data: Dict[str, Any]
    expected_cost: Optional[int] = None

class {ServiceName}ConsistencyTester:
    """Serviceä¸€è‡´æ€§æµ‹è¯•å™¨"""
    
    def __init__(self):
        self.setup_environment()
        self.old_repo = None
        self.new_repo = None
        self.supabase_manager = None
        self.container = None
        self.test_stats = {
            'total': 0,
            'consistent': 0, 
            'inconsistent': 0,
            'differences': []
        }
    
    def setup_environment(self):
        """è®¾ç½®æµ‹è¯•ç¯å¢ƒ"""
        os.environ.update({
            'SUPABASE_URL': 'your_url',
            'SUPABASE_KEY': 'your_key',
            '{SERVICE_NAME}_SERVICE_MIGRATION_MODE': 'parallel_test'
        })
    
    async def setup(self):
        """åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ"""
        # åˆå§‹åŒ–Container
        self.container = get_container()
        
        # åˆå§‹åŒ–Supabase
        self.supabase_manager = self.container.get("supabase_manager")
        await self.supabase_manager.initialize()
        
        # è·å–Repositoryå®ä¾‹
        self.old_repo = self.container.get("{old_repo_name}")
        self.new_repo = self.container.get("{new_repo_name}")
        
        # åˆ›å»ºæµ‹è¯•æ•°æ®
        await self.create_test_users()
    
    async def create_test_users(self):
        """åˆ›å»ºæµ‹è¯•ç”¨æˆ·"""
        # å®ç°æµ‹è¯•ç”¨æˆ·åˆ›å»ºé€»è¾‘
        pass
    
    async def execute_test_tasks(self, test_tasks: List[TestTask]):
        """æ‰§è¡Œæµ‹è¯•ä»»åŠ¡"""
        for task in test_tasks:
            try:
                # è°ƒç”¨æ—§Repository
                old_result = await self.old_repo.create_xxx({
                    'user_id': task.user_id,
                    'business_field': task.business_data,
                    'cost': task.expected_cost,
                    # ... å…¶ä»–å­—æ®µ
                })
                
                # è°ƒç”¨æ–°Repository
                new_result = await self.new_repo.create_xxx_with_payment(
                    user_id=task.user_id,
                    task_type=task.task_type,
                    business_data=task.business_data,
                    cost=task.expected_cost,  # ç¡®ä¿ä¼ é€’ç›¸åŒçš„æˆæœ¬
                    # ... å…¶ä»–å‚æ•°
                )
                
                # å¯¹æ¯”ç»“æœ
                await self.compare_records(task, old_result, new_result)
                
            except Exception as e:
                print(f"âŒ ä»»åŠ¡æ‰§è¡Œå¤±è´¥: {e}")
                self.test_stats['inconsistent'] += 1
    
    async def compare_records(self, task: TestTask, old_result: Dict, new_result: Dict):
        """å¯¹æ¯”è®°å½•ä¸€è‡´æ€§"""
        self.test_stats['total'] += 1
        
        # å®šä¹‰éœ€è¦å¯¹æ¯”çš„å­—æ®µ
        compare_fields = ['user_id', 'business_id', 'cost', 'status']
        differences = []
        
        for field in compare_fields:
            old_val = old_result.get(field)
            new_val = new_result.get(field)
            
            if old_val != new_val:
                differences.append({
                    'field': field,
                    'old_value': old_val,
                    'new_value': new_val,
                    'task_data': task.business_data
                })
        
        if differences:
            self.test_stats['inconsistent'] += 1
            self.test_stats['differences'].extend(differences)
            print(f"âŒ å‘ç°ä¸ä¸€è‡´: {differences}")
        else:
            self.test_stats['consistent'] += 1
            print(f"âœ… æ•°æ®ä¸€è‡´")
    
    async def generate_report(self):
        """ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š"""
        total = self.test_stats['total']
        consistent = self.test_stats['consistent']
        inconsistent = self.test_stats['inconsistent']
        consistency_rate = (consistent / total * 100) if total > 0 else 0
        
        print(f"\n{'='*50}")
        print(f"ğŸ“Š {self.__class__.__name__} æµ‹è¯•æŠ¥å‘Š")
        print(f"{'='*50}")
        print(f"æ€»ä»»åŠ¡æ•°: {total}")
        print(f"ä¸€è‡´ä»»åŠ¡: {consistent}")
        print(f"ä¸ä¸€è‡´ä»»åŠ¡: {inconsistent}")
        print(f"ä¸€è‡´æ€§ç‡: {consistency_rate:.1f}%")
        
        if self.test_stats['differences']:
            print(f"\nâŒ å‘ç° {len(self.test_stats['differences'])} ä¸ªå·®å¼‚:")
            for i, diff in enumerate(self.test_stats['differences'], 1):
                print(f"  {i}. å­—æ®µ'{diff['field']}': æ—§={diff['old_value']} vs æ–°={diff['new_value']}")
        else:
            print(f"\nâœ… æ‰€æœ‰æ•°æ®å®Œå…¨ä¸€è‡´!")
        
        return consistency_rate == 100.0

async def main():
    parser = argparse.ArgumentParser(description='{ServiceName}å¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æµ‹è¯•')
    parser.add_argument('--mode', choices=['quick', 'full'], default='quick', help='æµ‹è¯•æ¨¡å¼')
    parser.add_argument('--records', type=int, default=5, help='æµ‹è¯•è®°å½•æ•°é‡')
    args = parser.parse_args()
    
    tester = {ServiceName}ConsistencyTester()
    await tester.setup()
    
    # ç”Ÿæˆæµ‹è¯•ä»»åŠ¡
    test_tasks = []
    for i in range(args.records):
        test_tasks.append(TestTask(
            user_id=1000 + i,
            task_type='test_type',
            business_data={'index': i, 'mode': args.mode},
            expected_cost=10 + i
        ))
    
    # æ‰§è¡Œæµ‹è¯•
    await tester.execute_test_tasks(test_tasks)
    
    # ç”ŸæˆæŠ¥å‘Š
    success = await tester.generate_report()
    
    if not success:
        exit(1)

if __name__ == "__main__":
    asyncio.run(main())
```

## ğŸ“Š æŠ¥å‘Šæ ¼å¼æ ‡å‡†

### 1. æ§åˆ¶å°è¾“å‡ºæ ¼å¼
```
==================================================
ğŸ“Š ServiceConsistencyTester æµ‹è¯•æŠ¥å‘Š  
==================================================
æ€»ä»»åŠ¡æ•°: 10
ä¸€è‡´ä»»åŠ¡: 9
ä¸ä¸€è‡´ä»»åŠ¡: 1
ä¸€è‡´æ€§ç‡: 90.0%

âŒ å‘ç° 2 ä¸ªå·®å¼‚:
  1. å­—æ®µ'cost': æ—§=15 vs æ–°=10
  2. å­—æ®µ'status': æ—§=pending vs æ–°=created
```

### 2. è¯¦ç»†æ—¥å¿—æ ¼å¼
```
[2024-01-15 10:30:15] INFO - ğŸ”§ å¼€å§‹æ‰§è¡Œå¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æµ‹è¯•
[2024-01-15 10:30:16] INFO - âœ… æ—§Repositoryå†™å…¥æˆåŠŸ: task_id=12345
[2024-01-15 10:30:16] INFO - âœ… æ–°Repositoryå†™å…¥æˆåŠŸ: task_id=12345  
[2024-01-15 10:30:17] ERROR - âŒ å‘ç°ä¸ä¸€è‡´: å­—æ®µ'cost'å·®å¼‚
[2024-01-15 10:30:18] INFO - ğŸ“Š æµ‹è¯•å®Œæˆï¼Œä¸€è‡´æ€§ç‡: 90.0%
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æµ‹è¯•æ•°æ®è®¾è®¡
- **çœŸå®æ€§**ï¼šä½¿ç”¨æ¥è¿‘ç”Ÿäº§ç¯å¢ƒçš„æµ‹è¯•æ•°æ®
- **å®Œæ•´æ€§**ï¼šè¦†ç›–æ‰€æœ‰ä¸šåŠ¡åœºæ™¯å’Œè¾¹ç•Œæ¡ä»¶
- **éš”ç¦»æ€§**ï¼šæµ‹è¯•æ•°æ®ä¸å½±å“ç”Ÿäº§ç¯å¢ƒ

### 2. é”™è¯¯å¤„ç†
- **æ¸è¿›å¼è§£å†³**ï¼šä»ç¯å¢ƒâ†’æ•°æ®â†’é€»è¾‘ï¼Œé€å±‚è§£å†³é—®é¢˜
- **è¯¦ç»†æ—¥å¿—**ï¼šè®°å½•æ¯ä¸ªæ­¥éª¤çš„æ‰§è¡ŒçŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯
- **ä¼˜é›…é™çº§**ï¼šå•ä¸ªæµ‹è¯•å¤±è´¥ä¸å½±å“æ•´ä½“æµ‹è¯•æµç¨‹

### 3. æ€§èƒ½ä¼˜åŒ–
- **å¹¶å‘æ§åˆ¶**ï¼šé¿å…è¿‡å¤šå¹¶å‘è¯·æ±‚å¯¼è‡´æ•°æ®åº“å‹åŠ›
- **æ‰¹é‡æ“ä½œ**ï¼šåˆç†ä½¿ç”¨æ‰¹é‡åˆ›å»ºå’ŒæŸ¥è¯¢
- **èµ„æºæ¸…ç†**ï¼šæµ‹è¯•å®Œæˆåæ¸…ç†ä¸´æ—¶æ•°æ®

### 4. æŒç»­é›†æˆ
- **è‡ªåŠ¨åŒ–æ‰§è¡Œ**ï¼šé›†æˆåˆ°CI/CDæµç¨‹ä¸­
- **ç»“æœé€šçŸ¥**ï¼šæµ‹è¯•å¤±è´¥æ—¶åŠæ—¶é€šçŸ¥ç›¸å…³äººå‘˜
- **å†å²è¿½è¸ª**ï¼šè®°å½•æ¯æ¬¡æµ‹è¯•çš„ç»“æœå’Œè¶‹åŠ¿

## ğŸ”„ è¿ç§»æµç¨‹é›†æˆ

### 1. è¿ç§»å‰éªŒè¯
```bash
# æ‰§è¡Œå®Œæ•´ä¸€è‡´æ€§æµ‹è¯•
python test_service_parallel_write_consistency.py --mode=full --records=100

# è¦æ±‚: ä¸€è‡´æ€§ç‡ = 100%
```

### 2. è¿ç§»ä¸­ç›‘æ§
```bash
# åœ¨parallel_testæ¨¡å¼ä¸‹æŒç»­ç›‘æ§
python test_service_parallel_write_consistency.py --mode=monitor --interval=300

# å®šæœŸæ£€æŸ¥ä¸€è‡´æ€§ï¼Œå‘ç°é—®é¢˜åŠæ—¶å›æ»š
```

### 3. è¿ç§»åéªŒè¯
```bash
# éªŒè¯migratedæ¨¡å¼çš„æ­£ç¡®æ€§
python test_service_parallel_write_consistency.py --mode=migrated --records=50

# ç¡®ä¿æ–°Repositoryç‹¬ç«‹è¿è¡Œæ­£å¸¸
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ActionRecordServiceè¿ç§»åˆ‡æ¢æœºåˆ¶è¯¦è§£](./ActionRecordServiceè¿ç§»åˆ‡æ¢æœºåˆ¶è¯¦è§£.md)
- [Serviceä¸ç»„åˆRepositoryè°ƒç”¨å…³ç³»åˆ†ææŠ¥å‘Š](./Serviceä¸ç»„åˆRepositoryè°ƒç”¨å…³ç³»åˆ†ææŠ¥å‘Š.md)
- [ç»„åˆRepositoryé›†æˆéªŒè¯æŠ¥å‘Š](./ç»„åˆRepositoryé›†æˆéªŒè¯æŠ¥å‘Š.md)

## ğŸ‰ æ€»ç»“

æœ¬æ–¹æ¡ˆåŸºäºImageServiceçš„æˆåŠŸå®è·µï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„å¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æ£€éªŒä½“ç³»ã€‚é€šè¿‡æ ‡å‡†åŒ–çš„æµ‹è¯•æµç¨‹ã€æ¨¡æ¿åŒ–çš„å®ç°æ–¹æ¡ˆå’Œç³»ç»ŸåŒ–çš„é—®é¢˜è§£å†³ç­–ç•¥ï¼Œç¡®ä¿æ‰€æœ‰Serviceåœ¨è¿ç§»è¿‡ç¨‹ä¸­éƒ½èƒ½ä¿æŒæ•°æ®ä¸€è‡´æ€§å’Œä¸šåŠ¡é€»è¾‘çš„å®Œæ•´æ€§ã€‚

**æ ¸å¿ƒä»·å€¼**:
1. **é£é™©æ§åˆ¶**ï¼šæå‰å‘ç°è¿ç§»é£é™©ï¼Œé¿å…ç”Ÿäº§äº‹æ•…
2. **è´¨é‡ä¿éšœ**ï¼šç¡®ä¿æ–°æ—§ç³»ç»Ÿçš„å®Œå…¨ç­‰ä»·æ€§
3. **æ ‡å‡†åŒ–**ï¼šå»ºç«‹ç»Ÿä¸€çš„æµ‹è¯•æ ‡å‡†å’Œæµç¨‹
4. **å¯å¤ç”¨**ï¼šä¸ºåç»­Serviceè¿ç§»æä¾›å¯å¤ç”¨çš„æ–¹æ¡ˆæ¨¡æ¿

éµå¾ªæœ¬æ–¹æ¡ˆè¿›è¡Œå¹¶è¡Œå†™å…¥ä¸€è‡´æ€§æ£€éªŒï¼Œå°†å¤§å¤§æé«˜è¿ç§»çš„æˆåŠŸç‡å’Œç³»ç»Ÿçš„ç¨³å®šæ€§ï¼ 